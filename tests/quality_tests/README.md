# Тесты качества для генератора математических задач ЕГЭ

Эта директория содержит тесты для оценки качества генерируемых задач ЕГЭ. Основное внимание уделяется проверке уравнений и неравенств.

## Основные компоненты

- **test_equations.py** - Тесты для оценки качества генерации уравнений
- **test_inequalities.py** - Тесты для оценки качества генерации неравенств
- **run_quality_tests.py** - Скрипт для запуска всех тестов качества

## Возможности парсера математических выражений

Недавние улучшения в парсере позволяют корректно обрабатывать следующие типы выражений:

### Для уравнений

- ✅ Корректная обработка отрицательных чисел и отрицательных дробей (`-\frac{a}{b}`)
- ✅ Поддержка степеней в LaTeX формате `a^{bx+c}`
- ✅ Обработка тригонометрических выражений с константой `\pi`
- ✅ Автоматическое исправление несбалансированных скобок
- ✅ Поддержка логарифмов с коэффициентами (например, `2\log_3(2)`)
- ✅ Преобразование вложенных математических конструкций
- ✅ Обработка сложных дробей с корнями (например, `\frac{1 + \sqrt{133}}{2}`)
- ✅ Корректная обработка десятичных чисел с запятой вместо точки (например, `0,5` -> `0.5`)
- ✅ Корректное извлечение корней из ответов (например, `\sqrt{35}`)
- ✅ Улучшенная обработка тригонометрических выражений с `\pi` внутри аргумента

### Для неравенств

- ✅ Корректная обработка дробей в интервалах (`a/b`)
- ✅ Поддержка отрицательных границ интервалов (`[-2, 3]`)
- ✅ Поддержка степеней в LaTeX формате `a^{bx+c}`
- ✅ Обработка тригонометрических выражений с константой `\pi`
- ✅ Автоматическое исправление несбалансированных скобок
- ✅ Автоматическое выявление интервалов в различных форматах записи (`[a,b]`, `(a,b)`, `x > a`, `x < b`)
- ✅ Поддержка объединения интервалов (`x <= a или x >= b`)
- ✅ Корректная обработка десятичных чисел с запятой вместо точки
- ✅ Улучшенное извлечение неравенств из LaTeX-выражений

## Планируемые улучшения парсера

- ⏳ Расширение поддержки для бесконечных интервалов в различных форматах (`(-∞, a)`, `(b, +∞)`)
- ⏳ Обработка специальных математических функций (включая гиперболические и обратные тригонометрические)
- ⏳ Расширенная поддержка параметрических уравнений и неравенств
- ⏳ Улучшение обработки матричных выражений и определителей
- ⏳ Улучшенный алгоритм распознавания формул в сканированных материалах

## Улучшенная логика проверки ответов

- ✅ Гибкая проверка уравнений: успешным считается наличие хотя бы одного корректного ответа 
- ✅ Проверка на частичное совпадение множеств решений для неравенств
- ✅ Обработка специальных случаев для бесконечных интервалов в неравенствах
- ✅ Проверка точек из ответа на соответствие решению неравенства

## Планируемые улучшения логики проверки

- ⏳ Автоматический анализ промежуточных шагов решения на корректность
- ⏳ Проверка альтернативных методов решения и их валидация
- ⏳ Расширенный анализ ошибок в решениях с предоставлением конкретных исправлений
- ⏳ Интеллектуальное определение сложности решения и его оценка
- ⏳ Классификация типов ошибок и рекомендации по их исправлению

## Запуск тестов

Для запуска всех тестов качества используйте:

```bash
python -m tests.quality_tests.run_quality_tests
```

Для более детального анализа с сохранением отчета:

```bash
python -m tests.quality_tests.run_quality_tests --verbose --save-report
```

Для запуска тестов по конкретным типам задач:

```bash
python -m tests.quality_tests.run_specific_test --test-type="equation" --count=5
```

## Новые возможности тестирования

1. ✅ Добавлено отслеживание статистики выполнения тестов
2. ✅ Сохранение информации о неудачных тестах для дальнейшего анализа
3. ✅ Вывод общей статистики тестирования в конце работы скрипта
4. ✅ Более гибкие алгоритмы проверки соответствия ответов решениям Sympy
5. ✅ Расширенная диагностика с подробным логированием процесса проверки

## Планируемые улучшения системы тестирования

1. ⏳ Автоматическая классификация задач по типам и уровням сложности
2. ⏳ Генерация тестовых отчетов с визуализацией результатов
3. ⏳ Интеграция с CI/CD для непрерывного тестирования качества генерации
4. ⏳ A/B тестирование различных промптов для выявления оптимальных
5. ⏳ Тестирование качества подсказок с точки зрения педагогической ценности

## Структура отчета 

После выполнения тестов качества будет выведена следующая информация:

- Общее количество проверенных задач
- Число успешно распознанных задач (корректно извлечены уравнения/неравенства и ответы)
- Число корректно верифицированных задач
- Процент успешных тестов

## Интеграция с системой визуализации

В планах реализовать следующие улучшения для тестирования визуализации:

1. ⏳ Автоматическая проверка соответствия визуализации текстовому описанию задачи
2. ⏳ Тестирование корректности масштабирования и пропорций в геометрических фигурах
3. ⏳ Проверка читаемости подписей на графиках и диаграммах
4. ⏳ Валидация математической точности отображения графиков функций
5. ⏳ Тестирование интерактивных элементов в визуализации

## Расширение тестирования для новых типов задач

В ближайшее время планируется разработка тестов для:

1. ⏳ Задач по комбинаторике и теории вероятностей
2. ⏳ Задач по планиметрии с автоматической проверкой свойств фигур
3. ⏳ Задач по стереометрии с валидацией 3D-моделей
4. ⏳ Задач с параметрами и проверкой различных случаев
5. ⏳ Текстовых задач с валидацией математической модели

## Дальнейшие улучшения

В процессе разработки находятся:

1. ⏳ Более детальный анализ ошибок в процессе парсинга
2. ⏳ Расширение поддержки для более сложных математических выражений
3. ⏳ Визуализация результатов тестирования
4. ⏳ Автоматическое обновление базы тестовых примеров
5. ⏳ Поддержка параметрических ответов и ответов с переменными
6. ⏳ Интеграция с инструментами статического анализа кода
7. ⏳ Разработка эталонных задач для проверки корректности генерации
8. ⏳ Создание расширенных метрик качества для оценки генерируемых задач 