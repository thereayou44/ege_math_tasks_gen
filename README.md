# ЕГЭ Math Tasks Generator

Генератор математических задач ЕГЭ с адаптивными подсказками.

## Возможности

- Генерация новых задач ЕГЭ по различным разделам и темам математики
- Полные решения задач с пояснениями
- Система адаптивных подсказок различного уровня
- Поддержка различных механизмов генерации:
  - Локальные языковые модели (работают офлайн)
  - YandexGPT API (требуется API-ключ)
  - Дообученные модели YandexGPT (лучшее качество для ЕГЭ по математике)

## Требования

- Python 3.8+
- Для локальных моделей: минимум 16 ГБ ОЗУ (рекомендуется 32 ГБ)
- Для YandexGPT API: API-ключ и идентификатор каталога Яндекс.Облака

## Установка и настройка

1. Клонируйте репозиторий и установите зависимости:
```
git clone https://github.com/yourusername/ege_math_tasks_gen.git
cd ege_math_tasks_gen
pip install -r requirements.txt
```

2. Создайте файл `.env` со следующими настройками:
```
YANDEX_API_KEY=ваш_api_ключ_яндекса
YANDEX_FOLDER_ID=ваш_идентификатор_каталога_облака
GENERATOR_TYPE=yandex  # или local для использования локальных моделей
```

3. Запустите приложение:
```
python app.py
```

## Дообучение модели YandexGPT

Для достижения наилучших результатов генерации математических задач ЕГЭ, вы можете выполнить дообучение модели YandexGPT на специализированном датасете. Это повысит качество генерируемых задач, решений и подсказок.

### Шаг 1: Подготовка датасета

1. Создайте файл датасета в формате JSONL (каждая строка - отдельный JSON с парой "запрос-ответ")
2. Структура данных должна соответствовать формату для дообучения YandexGPT:
```json
{"messages": [{"role": "user", "content": "Сгенерируй задачу ЕГЭ по математике на тему 'Геометрия'"}, {"role": "assistant", "content": "УСЛОВИЕ: ... РЕШЕНИЕ: ... ПОДСКАЗКА-1: ... ПОДСКАЗКА-2: ... ПОДСКАЗКА-3: ..."}]}
```

Вы можете использовать скрипт `prepare_dataset.py` для автоматической генерации такого датасета.

### Шаг 2: Загрузка датасета в Яндекс.Облако

Для загрузки датасета используйте скрипт `upload_dataset.py`:

```bash
python upload_dataset.py путь_к_датасету.jsonl
```

Скрипт загрузит датасет и сохранит его ID в файл `.env`.

### Шаг 3: Запуск дообучения модели

Для запуска дообучения используйте скрипт `start-tuning.py`:

```bash
python start-tuning.py
```

Скрипт автоматически использует ID датасета из файла `.env`, или вы можете передать его как аргумент:

```bash
python start-tuning.py идентификатор_датасета
```

### Шаг 4: Использование дообученной модели

После завершения дообучения ID или URI модели будет сохранен в файл `.env`. Для тестирования дообученной модели используйте скрипт `test_tuned.py`:

```bash
python test_tuned.py
```

Или для тестирования в веб-интерфейсе:

```bash
python test_tuned.py test
```

## Режимы генерации

### 1. Локальные модели

- Преимущества: бесплатные, не требуют подключения к интернету
- Недостатки: требуют значительных вычислительных ресурсов, качество может быть ниже
- Настройка: установите `GENERATOR_TYPE=local` в файле `.env`

### 2. YandexGPT API

- Преимущества: высокое качество генерации, меньшие требования к ресурсам
- Недостатки: требуется API-ключ и оплата запросов (дешевле, чем OpenAI)
- Настройка: установите `GENERATOR_TYPE=yandex` в файле `.env`

### 3. Дообученная модель YandexGPT

- Преимущества: наилучшее качество для задач ЕГЭ по математике, лучшее соотношение цена/качество
- Недостатки: требуется время на дообучение (несколько часов)
- Настройка: выполните процесс дообучения, описанный выше, и установите `GENERATOR_TYPE=yandex` в файле `.env`

## Структура проекта

- `app.py` - основное Flask-приложение
- `task_generator.py` - логика генерации заданий через YandexGPT
- `local_task_generator.py` - генерация заданий через локальные модели
- `templates/` - HTML-шаблоны для веб-интерфейса
- `static/` - CSS, JavaScript и другие статические файлы
- `upload_dataset.py` - инструмент для загрузки датасетов в Яндекс.Облако
- `start-tuning.py` - инструмент для запуска дообучения моделей
- `test_tuned.py` - тестирование дообученных моделей
- `prepare_dataset.py` - генерация датасетов для дообучения

## Как это работает

1. Приложение получает запрос на генерацию задачи с указанием раздела, темы и уровня сложности
2. Запрос передается в подходящий генератор задач (YandexGPT или локальный)
3. Генератор формирует условие задачи, её полное решение и адаптивные подсказки
4. Пользователю показывается условие задачи, и он может поэтапно запрашивать подсказки или просмотреть полное решение

## Вклад в проект

Приветствуются любые улучшения и исправления! Создайте pull request или опишите проблему в разделе Issues.

## Лицензия

MIT
