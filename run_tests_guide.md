# Руководство по запуску тестов качества для генератора задач ЕГЭ

## Предварительные требования

Перед запуском тестов убедитесь, что:

1. Установлены все необходимые зависимости из файла `requirements.txt`
   ```bash
   pip install -r requirements.txt
   ```

2. Создан файл `.env` в корневом каталоге проекта, содержащий следующие переменные:
   ```
   YANDEX_API_KEY=ваш_ключ_API_Яндекса
   YANDEX_FOLDER_ID=идентификатор_вашей_папки
   ```

3. В системе установлены необходимые пакеты для работы с математическими выражениями:
   ```bash
   pip install sympy matplotlib numpy
   ```

## Запуск тестов качества

### Метод 1: Запуск всех тестов

Для запуска всех тестов качества выполните:

```bash
python tests/quality_tests/run_quality_tests.py
```

Этот скрипт последовательно запустит:
- Тесты качества генерации уравнений
- Тесты качества генерации неравенств
- Выведет общую статистику по результатам тестирования

### Метод 2: Запуск отдельных модулей тестирования

Вы можете запустить тесты для отдельных типов задач:

#### Для уравнений:
```bash
python -c "from tests.quality_tests.test_equations import EquationQualityTest; EquationQualityTest().test_equation_generation_quality()"
```

#### Для неравенств:
```bash
python -c "from tests.quality_tests.test_inequalities import InequalityQualityTest; InequalityQualityTest().test_inequality_generation_quality()"
```

## Интерпретация результатов

После завершения тестов вы увидите статистику в следующем формате:

```
СТАТИСТИКА ТЕСТИРОВАНИЯ КАЧЕСТВА
======================================================================
Уравнения: проверено задач - 30
Уравнения: успешно распознаны - 15
Уравнения: корректно верифицированы - 12

Неравенства: проверено задач - 30
Неравенства: успешно распознаны - 18
Неравенства: корректно верифицированы - 15

Процент успеха для уравнений: 80.00%
Процент успеха для неравенств: 83.33%
Общий процент успеха: 81.82%
```

### Пояснение метрик:

- **Проверено задач** — общее количество попыток генерации задач
- **Успешно распознаны** — количество задач, для которых удалось извлечь уравнение/неравенство и ответ
- **Корректно верифицированы** — количество задач, для которых ответ соответствует уравнению/неравенству

Процент успеха рассчитывается как отношение количества корректно верифицированных задач к количеству успешно распознанных.

## Логирование

Подробные результаты тестирования сохраняются в файл `quality_tests.log` в корневом каталоге проекта. 
Этот файл содержит детальную информацию о каждом тесте, включая:

- Извлеченные уравнения/неравенства
- Найденные ответы
- Ошибки и предупреждения
- Результаты проверки

Просмотр лога может быть полезен для отладки и улучшения алгоритмов генерации задач.

```bash
tail -f quality_tests.log
```

## Настройка параметров тестирования

При необходимости вы можете изменить следующие параметры в файлах тестов:

1. **Количество попыток генерации** — параметр `max_attempts` в методах `test_equation_generation_quality` и `test_inequality_generation_quality`
2. **Уровень сложности задач** — параметр `difficulty_level` в вызове `generate_complete_task`

## Решение проблем

Если тесты качества не проходят:

1. Убедитесь, что API ключи Яндекса корректны и действительны
2. Проверьте наличие всех необходимых зависимостей
3. Изучите содержимое лог-файла `quality_tests.log` для получения детальной информации об ошибках
4. Проверьте, что модели генерации задач работают корректно, запустив простую генерацию через `app.py` 